<html>
<head>
    <meta http-equiv="Refresh" content="3">
    <title>Megrez client</title>
    <style type="text/css">
        .pipeline {
            font-weight: bold;
        }

        .ongoing {
            color: orange;
        }

        .completed {
            color: green;
        }

        .failed {
            color: red;
        }

        .unknown {
            color: gray;
        }
    </style>
</head>
<body>
<div id="content"></div>
<script type="text/javascript">
    function onStatusChange(json) {
        var html = "";
        for (var i = 0; i < json.pipelines.length; i++) {
            var pipeline = json.pipelines[i]
            html += "<p><span class='pipeline'>" + pipeline.name + "</span><br>";
            for (var j = 0; j < pipeline.stages.length; j++) {
                var stage = pipeline.stages[j];
                html += "<span class='stage " + stage.status + "'>" + stage.name + "</span>";
                if (j != pipeline.stages.length - 1) {
                    html += " -&#62; ";
                }
            }
            html += "</p>";
        }
        document.getElementById("content").innerHTML = html;
    }
</script>
<div id="loader">
    <script type="text/javascript" src="http://localhost:8051/builds.js"/>
</div>
<script type="text/javascript">
    function refresh() {
        var loader = document.getElementById("loader")
        if (loader) {
            loader.innerHTML = loader.innerHTML;
        }
    }
    setInterval("refresh()", 5000);
</script>
</body>
</html>